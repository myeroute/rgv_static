---
import BaseLayout from "../layouts/BaseLayout.astro";
import PostCard from "../components/PostCard.astro";
import { getCollection } from "astro:content";

// Lấy toàn bộ bài blog
const allPosts = await getCollection("blog");

// Filter đúng category
const posts = allPosts
  .filter((post) => post.data.category === "retro-games")
  // sort mới → cũ cho gọn
  .sort(
    (a, b) =>
      new Date(b.data.pubDate).getTime() -
      new Date(a.data.pubDate).getTime()
  );
---

<BaseLayout title="Retro Games">
  <section class="container">
    <header class="page-header">
      <h1>Retro Games</h1>
      <p>
        This category is a space where I revisit older games and write down what
        it actually feels like to play them again today.
      </p>
    </header>

    {posts.length === 0 && (
      <p>No posts found in this category.</p>
    )}

    <div class="post-list">
      {posts.map((post) => (
        <PostCard post={post} />
      ))}
    </div>
  </section>
</BaseLayout>

<style>
  .container {
    max-width: 900px;
    margin: 0 auto;
    padding: 2rem 1rem;
  }

  .page-header {
    margin-bottom: 2.5rem;
  }

  .page-header h1 {
    font-size: 2.2rem;
    margin-bottom: 0.75rem;
  }

  .page-header p {
    color: #555;
    max-width: 720px;
  }

  .post-list {
    display: flex;
    flex-direction: column;
    gap: 2.5rem;
  }
</style>
