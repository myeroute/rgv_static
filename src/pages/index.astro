---
import BaseLayout from "../layouts/BaseLayout.astro";
import PostCard from "../components/PostCard.astro";
import { getCollection } from "astro:content";

/**
 * Homepage:
 * - Lấy bài từ collection blog
 * - Sort mới → cũ
 * - Render bằng PostCard (props tường minh)
 */

const posts = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort(
    (a, b) =>
      new Date(b.data.pubDate).getTime() -
      new Date(a.data.pubDate).getTime()
  );
---

<BaseLayout title="RetroGamingVerse">
  <main class="home">
    <section class="post-list">
      {posts.map((post) => (
        <PostCard
          title={post.data.title}
          href={`/${post.slug}/`}
          excerpt={post.data.description}
          image={post.data.heroImage}
          category={post.data.game ?? post.data.tag}
        />
      ))}
    </section>
  </main>
</BaseLayout>

<style>
.home {
  max-width: 960px;
  margin: 0 auto;
  padding: 2rem 1rem;
}

.post-list {
  display: flex;
  flex-direction: column;
}
</style>
