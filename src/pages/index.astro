---
import { getCollection } from "astro:content";
import PostCard from "../components/PostCard.astro";
import BaseLayout from "../layouts/BaseLayout.astro";

const posts = await getCollection("blog");

const sortedPosts = posts
  .filter((p) => p.data)
  .sort((a, b) => {
    const da = a.data.pubDate ? new Date(a.data.pubDate).getTime() : 0;
    const db = b.data.pubDate ? new Date(b.data.pubDate).getTime() : 0;
    return db - da;
  });
---

<BaseLayout>
  <main class="home">
    <section class="post-list">
      {sortedPosts.map((post) => (
        <PostCard post={post} />
      ))}
    </section>
  </main>
</BaseLayout>

<style>
.home {
  max-width: 920px;
  margin: 0 auto;
  padding: 32px 16px;
}
</style>
