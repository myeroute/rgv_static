---
import BaseLayout from "../layouts/BaseLayout.astro";
import PostCard from "../components/PostCard.astro";
import { getCollection } from "astro:content";

// Lấy toàn bộ bài blog
const allPosts = await getCollection("blog");

// Lọc theo CATEGORY (KHÔNG phải tag)
const posts = allPosts
  .filter((post) => post.data.category === "retro-style-indie-games")
  .sort(
    (a, b) =>
      new Date(b.data.pubDate).getTime() -
      new Date(a.data.pubDate).getTime()
  );
---

<BaseLayout
  title="Retro-Style Indie Games"
  description="Articles and reflections on indie games inspired by retro design."
>
  <main class="page">
    <header class="page-header">
      <h1>Retro-Style Indie Games</h1>
      <p>
        Indie games influenced by retro aesthetics, mechanics, and design
        philosophy.
      </p>
    </header>

    {posts.length === 0 ? (
      <p>No posts found.</p>
    ) : (
      <section class="post-grid">
        {posts.map((post) => (
          <PostCard post={post} />
        ))}
      </section>
    )}
  </main>
</BaseLayout>

<style>
  .page {
    max-width: 1100px;
    margin: 0 auto;
    padding: 2rem 1rem;
  }

  .page-header {
    margin-bottom: 2rem;
  }

  .page-header h1 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
  }

  .page-header p {
    color: #777;
  }

  .post-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
  }
</style>
